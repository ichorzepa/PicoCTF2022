
# basic-file-exploit

Challenge from picoCTF 2022.



## Challenge description

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!
Connect to the program with netcat:

```
$ nc saturn.picoctf.net 52681
```
The program's source code with the flag redacted can be downloaded [[here]](https://artifacts.picoctf.net/c/543/program-redacted.c).


## Explained

Download code using ```wget```. Look inside. Find something related to flag:
```c
 if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
  }
```
after analysing further parts of code, you can find something similar:
```c
if ((command = strtol(input, NULL, 10)) == 0) {
      puts("Please put in a valid number");
```
Now you now that this condition is TRUE when input is not valid number. 

1. Run code.
2. type 1 to insert data, insert for example "data" and enter length: 4.
3. type 2 to read data, as entry number of data enter not a number, for example "aaa"

---
You get the code.


## ðŸ”— Links
[[https://play.picoctf.org/practice/challenge/252]](https://play.picoctf.org/practice/challenge/252)

